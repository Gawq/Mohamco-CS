# 0. 메모리

CPU는 그저 메모리에 올라와 있는 프로그램의 명령어를 실행할 뿐이다.

# 1. 메모리 계층

메모리 계층 구성 요소

- 레지스터 : 작은 메모리로 휘발성, 속도 빠름, 기억 용량이 가장 적음
- 캐시 : L1, L2 캐시 지칭, 휘발성, 속도 빠름, 기억 용량 적음, L3 캐시도 존재
- 메모리 : 주기억장치. 휘발성, 속도 보통, 기억 용량 보통
- 저장장치 : HDD, SSD를 일컬음, 속도 낮음, 기억 용량 많음

계층이 위로 올라갈수록 가격은 비싸지는데 용량은 작아지고 속도는 빨라지는 특징이 있다.

## 캐시

캐시는 데이터를 미리 복사해 놓는 임시 저장소이다.
빠른 장치와 느린 장치에서 속도 차이에 따른 병목 현상을 줄이기 위한 메모리이다.

실제로 메모리와 CPU 사이의 속도 차가 너무 커 그 중간에 레지스터 계층을 둬 속도 차이를 해결한다. 이러한 것들을 캐싱 계층이라 한다.

### 지역성의 원리

캐시를 계층에 두는 것 말고 직접 설정할때는 자주 사용하는 데이터 기반으로 설정해야 한다.
자주 데이터를 사용하는 근거는 지역성이다.

> **시간 지역성**<br>
> 최근 사용한 데이터에 다시 접근하려는 특성 for문의 i 예
>
> **공간 지역성**<br>
> 최근 접근한 데이터를 이루고 있는 공간이나 가까운 공간에 접근하는 특성 arr의 인덱스 요소로 연속적으로 접근하는 예

## 캐시히트와 캐시미스

캐시에서 원하는 데이터를 찾은 걸 캐시히트라고 한다.
그 반대로는 캐시미스라고 한다. 캐시미스는 주 메모리로 가서 데이터를 찾아오는 것이다.

### 웹 브라우저의 캐시

웹 브라우저의 작은 저장소로는 쿠키, 로컬 스토리지, 세션 스토리지가 있다.
이러한 것들은 사용자의 정보나 인증 모듈 관련 사항들을 웹에 저장해 추후 서버에 요청할 때 자신을 나타내는 아이덴티티나 중복 요청 방지를 위해 스인다.

#### 쿠키

- 만료기한이 있는 키-값 저장소
- 4kb까지 저장 가능
- 다른 도메인에서 요청 가능
- 만료 기한을 클라, 서버에서 설정 가능

#### 로컬 스토리지

- 만료기한이 없는 키-값 저장소
- 10MB까지 저장 가능
- 브라우저를 닫아도 유지
- 도메인 단위
- 클라에서만 수정 가능

#### 세션 스토리지

- 만료기한이 없는 키-값 저장소
- 맵 단위로 생성
- 브라우저 탭을 닫으면 데이터 삭제
- 5MB까지 저장 가능
- 클라에서만 수정 가능

# 2. 메모리 관리

운영체제의 대표적인 할 일 중 하나가 메모리 관리이다. 컴퓨터 내의 한정된 메모리를 극한으로 활용해야 하는 것이다..

## 가상 메모리

가상메모리는 메모리 관리 기법의 하나로 메모리 자원을 추상화한 것이다.
가상으로 주어진 주소를 가상 주소라고 하며 실제 메모리상 주소는 실제 주소라고 한다.
가상 주소는 메모리관리장치에 의해 실제 주소로 변환되어 사용자는 실제 주소를 의식할 필요 없이 프로그램을 구축할 수 있다.

### 스와핑

가상 메모리에는 존재하는데 실제 메모리에는 없으면 페이지 폴트가 발생하는데 이때 메모리에서 당장 사용하지 않는 영역을 하드로 옮기고 하드 일부를 마치 메모리처럼 불러와 쓰는 것을 스와핑이라고 한다.
이를 통해 페이지 폴트가 일어나지 않은 것처럼 만든다.

### 페이지 폴트

페이지 폴트란 프로세스의 주소 공간에는 존재하지만 지금의 메모리에는 없는 데이터에 접근했을 경우에 발생한다.

## 스레싱

스레싱은 메모리 페이지 폴트율이 높은 것을 의미한다.
즉 스와핑이 많이 일어나서 발생하는 것이다.
이를 해결하기 위해서는 메모리를 늘리거나 HDD를 사용한다면 SSD로 교체하는 방법이 있다.
운영체제에서 해결하려면 작업 세트와 PFF가 있다.

## 메모리 할당

메모리에 프로그램을 할당할 때는 시작 메모리 위치, 메모리 할당 크기를 기반으로 할당하는데 연속 할당과 불연속 할당으로 나뉜다.

## 페이지 교체 알고리즘

메모리는 한정되어 있기에 스와핑이 많이 일어난다. 이를 그나마 해결하기 위해 페이지 교체 알고리즘을 기반으로 스와핑이 일어난다.

### 오프라인 알고리즘

오프라인 알고리즘은 미래에 참조되는 페이지와 현재 할당하는 페이지를 바꾸는 알고리즘이며 가장 이상적인 방법이다.
그러나 미래에 사용되는 프로세스를 알 수 없으니 없는 사용할 수 없다.
하지만 이를 통해 다른 알고리즘과 성능 비교를 하는 기준이 된다.

### FIFO

First In First Out은 가장 먼저 온 페이지를 교체 영역에 가장 먼저 놓는 방법을 의미한다.

### LRU

Lest Recentle Used는 참조가 가장 오래된 페이지를 바꾼다.
오래된 것을 파악하기 위해 각 페이지마다 계수기, 스택을 두어야 하는 문제점이 있다.

### LFU

Lest Frequently Used는 가장 참조 횟수가 적은 페이지를 교체한다. 즉 많이 사용되지 않은 것을 교체하는 것이다.
